"use strict";(self.webpackChunkvessel_tracking=self.webpackChunkvessel_tracking||[]).push([[631],{5631:($,d,s)=>{s.r(d),s.d(d,{RoutePlanModule:()=>G});var c=s(8583),t=s(639),f=s(6290),u=s(9681);let Z=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-route-plan"]],decls:4,vars:0,consts:[[1,"my-4"],[1,"container"]],template:function(e,n){1&e&&(t._UZ(0,"app-header"),t.TgZ(1,"main",0),t.TgZ(2,"div",1),t._UZ(3,"router-outlet"),t.qZA(),t.qZA())},directives:[f.G,u.lC],encapsulation:2}),o})();var p=s(665),C=s(3778),m=s(4283),x=s(2897);let T=(()=>{class o{constructor(e){this.vesselService=e,this.vessels=[]}ngOnInit(){this.vesselsSub=this.vesselService.getVessels().subscribe(e=>{this.vessels=e})}ngOnDestroy(){this.vesselsSub.unsubscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.I))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-route-plan-vessels"]],decls:5,vars:1,consts:[[1,"text-center"],[3,"vessels"]],template:function(e,n){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"\u{1f5fa}\ufe0f Route Planning"),t.qZA(),t.TgZ(2,"h2"),t._uU(3,"Select Vessel:"),t.qZA(),t._UZ(4,"app-vessels-list",1)),2&e&&(t.xp6(4),t.Q6J("vessels",n.vessels))},directives:[x.T],encapsulation:2}),o})();var A=s(7709),S=s(618),b=s(5883),D=s(153),P=s(2037),y=s(42),v=s(9463),g=s(9980),h=s(5625);function R(o,i){if(1&o&&(t.TgZ(0,"small",6),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.location.point)}}function U(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"app-list-item"),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t._uU(3),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw().remove(a)}),t._uU(5,"Delete"),t.qZA(),t.qZA(),t.TgZ(6,"p",2),t._uU(7),t.qZA(),t.TgZ(8,"div",4),t._uU(9),t.qZA(),t.YNc(10,R,2,1,"small",5),t.qZA()}if(2&o){const e=i.$implicit;t.xp6(3),t.hij("\u{1f4cd} ",e.name,""),t.xp6(4),t.Oqu(e.location.city+", "+e.location.country),t.xp6(2),t.hij("Capacity: ",e.capacity,""),t.xp6(1),t.Q6J("ngIf",e.location.point)}}let F=(()=>{class o{constructor(){this.onDelete=new t.vpe}ngOnInit(){}remove(e){this.onDelete.emit(e)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-ports-list"]],inputs:{ports:"ports"},outputs:{onDelete:"onDelete"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],["type","button",1,"btn","btn-outline-danger",3,"click"],[1,"fw-bold","fst-italic"],["class","text-muted",4,"ngIf"],[1,"text-muted"]],template:function(e,n){1&e&&(t.TgZ(0,"app-list-group"),t.YNc(1,U,11,4,"app-list-item",0),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",n.ports))},directives:[g.q,c.sg,h.G,c.O5],encapsulation:2,changeDetection:0}),o})();var O=s(8332);function J(o,i){if(1&o&&(t.TgZ(0,"small",6),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.stop.port.location.point)}}let M=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-stop"]],inputs:{stop:"stop"},decls:14,vars:8,consts:[[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],[1,"d-flex"],["app-badge","","pill","","color","success"],[1,"fw-bold","fst-italic"],["class","text-muted",4,"ngIf"],[1,"text-muted"]],template:function(e,n){1&e&&(t.TgZ(0,"app-list-group"),t.TgZ(1,"app-list-item"),t.TgZ(2,"div",0),t.TgZ(3,"h5",1),t._uU(4),t.qZA(),t.TgZ(5,"div",2),t.TgZ(6,"span",3),t._uU(7),t.ALo(8,"date"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"p",1),t._uU(10),t.qZA(),t.TgZ(11,"div",4),t._uU(12),t.qZA(),t.YNc(13,J,2,1,"small",5),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.hij("\u{1f4cd} ",n.stop.port.name,""),t.xp6(3),t.Oqu(t.xi3(8,5,n.stop.dateIn,"shortDate")),t.xp6(3),t.Oqu(n.stop.port.location.city+", "+n.stop.port.location.country),t.xp6(2),t.hij("Capacity: ",n.stop.port.capacity,""),t.xp6(1),t.Q6J("ngIf",n.stop.port.location.point))},directives:[g.q,h.G,v.F,c.O5],pipes:[c.uU],encapsulation:2,changeDetection:0}),o})();function _(o,i){if(1&o&&(t.TgZ(0,"option",13),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name+" ("+e.location.city+", "+e.location.country+")"," ")}}function I(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"app-alert",14),t.NdJ("onClose",function(){return t.CHM(e),t.oxw().closeAlert()}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("message",e.errMessage)}}function Q(o,i){if(1&o&&(t.ynx(0),t.TgZ(1,"h2"),t._uU(2,"\u{1f4cd} Current Stop"),t.qZA(),t._UZ(3,"app-stop",15),t.BQk()),2&o){const e=t.oxw();t.xp6(3),t.Q6J("stop",e.currentStop)}}let q=(()=>{class o{constructor(e,n,l,a,r){this.vesselService=e,this.portService=n,this.portalService=l,this.route=a,this.router=r,this.nextStops=[],this.isUnsaved=!1,this.errMessage="",this._modalConfirmation=new A.xQ,this.id=this.route.snapshot.paramMap.get("id")||""}canDeactivate(){return!this.isUnsaved||(this.openModal(),this._modalConfirmation.asObservable())}ngOnInit(){this.vesselSub=this.vesselService.getVessel(this.id).subscribe({error:()=>this.router.navigate(["/not-found"]),next:e=>{var n,l;this.vessel=e,this.nextStops=(null===(n=this.vessel)||void 0===n?void 0:n.nextStops.filter(a=>!(a.dateIn||a.dateOut)).map(a=>a.port))||[],this.currentStop=(null===(l=this.vessel)||void 0===l?void 0:l.nextStops.find(a=>a.dateIn||a.dateOut))||null}}),this.portsSub=this.portService.getPorts().subscribe(e=>{this.ports=e})}save(){this.editRoutesSub=this.vesselService.editNextRoutes(this.id,this.nextStops).subscribe({complete:()=>{this.isUnsaved=!1,this.router.navigate(["/route-plan"])}})}removeStop(e){this.nextStops=this.nextStops.filter((n,l)=>l!==e),this.isUnsaved=!0}addStop(e){var n,l;const a=this.ports.find(r=>r.id===e);a&&(null===(n=this.nextStops[this.nextStops.length-1])||void 0===n?void 0:n.id)!==e&&(null===(l=this.currentStop)||void 0===l?void 0:l.port.id)!==e?(this.nextStops=[...this.nextStops,a],this.isUnsaved=!0):this.errMessage="Cannot add same port as last neither than current"}closeAlert(){this.errMessage=""}openModal(){const e=this.portalService.open(S.z);e.title="Discard changes?",e.message="There are changes unsaved.",e.denyTitle="No",e.confirmTitle="Yes",e.onDeny.subscribe(()=>{this._modalConfirmation.next(!1),this.portalService.close()}),e.onConfirm.subscribe(()=>{this._modalConfirmation.next(!0),this.portalService.close()})}ngOnDestroy(){var e;this.vesselSub.unsubscribe(),this.portsSub.unsubscribe(),null===(e=this.editRoutesSub)||void 0===e||e.unsubscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.I),t.Y36(b.v),t.Y36(D.E),t.Y36(u.gz),t.Y36(u.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-route-plan-add"]],decls:20,vars:8,consts:[[3,"vessel"],["type","button","app-button","","size","large",1,"mx-1",3,"disabled","click"],["routePlanForm","ngForm"],[1,"input-group","mb-3"],["name","port","id","port","ngModel","","required","",1,"form-select","form-select-lg"],["port","ngModel"],["value","","selected","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-success",3,"disabled","click"],["type","warning",3,"message","onClose",4,"ngIf"],[4,"ngIf"],["app-badge","","color","secondary"],[3,"ports","onDelete"],[3,"value"],["type","warning",3,"message","onClose"],[3,"stop"]],template:function(e,n){if(1&e){const l=t.EpF();t.TgZ(0,"app-vessel-hero",0),t.TgZ(1,"button",1),t.NdJ("click",function(){return n.save()}),t._uU(2,"Save Plan"),t.qZA(),t.qZA(),t.TgZ(3,"form",null,2),t.TgZ(5,"div",3),t.TgZ(6,"select",4,5),t.TgZ(8,"option",6),t._uU(9,"Select Port"),t.qZA(),t.YNc(10,_,2,2,"option",7),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){t.CHM(l);const r=t.MAs(7),H=t.MAs(4);return n.addStop(r.value),H.resetForm({port:""})}),t._uU(12,"Add Route"),t.qZA(),t.qZA(),t.YNc(13,I,1,1,"app-alert",9),t.qZA(),t.YNc(14,Q,4,1,"ng-container",10),t.TgZ(15,"h2"),t._uU(16,"\u{1f4cd} Next Stops "),t.TgZ(17,"span",11),t._uU(18),t.qZA(),t.qZA(),t.TgZ(19,"app-ports-list",12),t.NdJ("onDelete",function(r){return n.removeStop(r)}),t.qZA()}if(2&e){const l=t.MAs(7);t.Q6J("vessel",n.vessel),t.xp6(1),t.Q6J("disabled",!n.isUnsaved),t.xp6(9),t.Q6J("ngForOf",n.ports),t.xp6(1),t.Q6J("disabled",l.invalid),t.xp6(2),t.Q6J("ngIf",n.errMessage),t.xp6(1),t.Q6J("ngIf",n.currentStop),t.xp6(4),t.Oqu(n.nextStops.length),t.xp6(1),t.Q6J("ports",n.nextStops)}},directives:[P.z,y.r,p._Y,p.JL,p.F,p.EJ,p.JJ,p.On,p.Q7,p.YN,p.Kr,c.sg,c.O5,v.F,F,O.w,M],encapsulation:2}),o})();var N=s(4865),Y=s(8562),j=s(1643),L=s(2563),V=s(4584),z=s(4712),E=s(9752),X=s(2024);const B=[{path:"",component:Z,children:[{path:"",component:T},{path:":id",component:q,canDeactivate:[j.a]},{path:"**",redirectTo:"/home"}]}];let G=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[c.ez,u.Bz.forChild(B),C.O,Y.g,p.u5,N.X,L.n,z.T,V.O,E.F,X.h]]}),o})()}}]);